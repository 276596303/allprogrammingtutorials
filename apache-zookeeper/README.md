You can find complete tutorial on Leader election using Apache ZooKeeper here - 

http://www.allprogrammingtutorials.com/tutorials/leader-election-using-apache-zookeeper.php
